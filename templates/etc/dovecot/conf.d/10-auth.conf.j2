#jinja2: trim_blocks: True, lstrip_blocks: True
# {{ ansible_managed }}

{% if dovecot_auth.disable_plaintext_auth is defined %}
disable_plaintext_auth       = {{ dovecot_auth.disable_plaintext_auth | bool | ternary('yes', 'no') }}
{% endif %}
{% if dovecot_auth.auth_cache_size is defined %}
auth_cache_size              = {{ dovecot_auth.auth_cache_size | int }}
{% endif %}
{% if dovecot_auth.auth_cache_ttl is defined and dovecot_auth.auth_cache_ttl | length > 0 %}
auth_cache_ttl               = {{ dovecot_auth.auth_cache_ttl }}
{% endif %}
{% if dovecot_auth.auth_cache_negative_ttl is defined and dovecot_auth.auth_cache_negative_ttl | length > 0 %}
auth_cache_negative_ttl      = {{ dovecot_auth.auth_cache_negative_ttl }}
{% endif %}
{% if dovecot_auth.auth_realms and dovecot_auth.auth_realms | count > 0 %}
auth_realms                  = {{ dovecot_auth.auth_realm | join(' ') }}
{% endif %}
{% if dovecot_auth.auth_default_realm is defined and dovecot_auth.auth_default_realm | length > 0 %}
auth_default_realm           = {{ dovecot_auth.auth_default_realm }}
{% endif %}
{% if dovecot_auth.auth_username_chars is defined and dovecot_auth.auth_username_chars | length > 0 %}
auth_username_chars          = {{ dovecot_auth.auth_username_chars }}
{% endif %}
{% if dovecot_auth.auth_username_translation is defined and dovecot_auth.auth_username_translation | length > 0 %}
auth_username_translation    = {{ dovecot_auth.auth_username_translation }}
{% endif %}
{% if dovecot_auth.auth_username_format is defined and dovecot_auth.auth_username_format | length > 0 %}
auth_username_format         = {{ dovecot_auth.auth_username_format }}
{% endif %}
{% if dovecot_auth.auth_master_user_separator is defined and dovecot_auth.auth_master_user_separator | length > 0 %}
auth_master_user_separator   = {{ dovecot_auth.auth_master_user_separator }}
{% endif %}
{% if dovecot_auth.auth_anonymous_username is defined and dovecot_auth.auth_anonymous_username | length > 0 %}
auth_anonymous_username      = {{ dovecot_auth.auth_anonymous_username }}
{% endif %}
{% if dovecot_auth.auth_worker_max_count is defined and dovecot_auth.auth_worker_max_count | int > 0 %}
auth_worker_max_count        = {{ dovecot_auth.auth_worker_max_count | int }}
{% endif %}
{% if dovecot_auth.auth_gssapi_hostname is defined and dovecot_auth.auth_gssapi_hostname | length > 0 %}
auth_gssapi_hostname         = {{ dovecot_auth.auth_gssapi_hostname }}
{% endif %}
{% if dovecot_auth.auth_krb5_keytab is defined and dovecot_auth.auth_krb5_keytab | length > 0 %}
auth_krb5_keytab             = {{ dovecot_auth.auth_krb5_keytab }}
{% endif %}
{% if dovecot_auth.auth_use_winbind is defined %}
auth_use_winbind             = {{ dovecot_auth.auth_use_winbind | bool | ternary('yes', 'no') }}
{% endif %}
{% if dovecot_auth.auth_winbind_helper_path is defined and dovecot_auth.auth_winbind_helper_path | length > 0 %}
auth_winbind_helper_path     = {{ dovecot_auth.auth_winbind_helper_path }}
{% endif %}
{% if dovecot_auth.auth_failure_delay is defined and dovecot_auth.auth_failure_delay | length > 0 %}
auth_failure_delay           = {{ dovecot_auth.auth_failure_delay }}
{% endif %}
{% if dovecot_auth.auth_ssl_require_client_cert is defined %}
auth_ssl_require_client_cert = {{ dovecot_auth.auth_ssl_require_client_cert | bool | ternary('yes', 'no') }}
{% endif %}
{% if dovecot_auth.auth_ssl_username_from_cert is defined %}
auth_ssl_username_from_cert  = {{ dovecot_auth.auth_ssl_username_from_cert | bool | ternary('yes', 'no') }}
{% endif %}
{% if dovecot_auth.auth_mechanisms is defined and dovecot_auth.auth_mechanisms | length > 0 %}
{% set _attr = [
  'plain', 'login',
  'digest-md5', 'cram-md5',
  'ntlm', 'rpa',
  'apop', 'anonymous',
  'gssapi', 'otp',
  'skey', 'gss-spnego'] %}
auth_mechanisms              = {{ dovecot_auth.auth_mechanisms | compare_list(_attr) | join(' ') }}
{% endif %}

{% if dovecot_auth.includes is defined and dovecot_auth.includes | count > 0 %}
{% for include in dovecot_auth.includes %}
{% if include is defined and not include == None %}
!include {{ include }}
{% endif %}
{% endfor %}
{% endif %}
